<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é‡‘èå›æ’¤/åå¼¹è®¡ç®—å™¨</title>
    <style>
        :root {
            --primary-color: #007AFF; /* iOS Blue */
            --secondary-color: #5AC8FA;
            --bg-color: #F2F2F7;
            --card-bg: #FFFFFF;
            --text-dark: #1C1C1E;
            --text-gray: #8E8E93;
            --success-color: #34C759;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background: var(--card-bg);
            width: 100%;
            max-width: 480px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        /* é¡¶éƒ¨å¯¼èˆª/æ¨¡å¼åˆ‡æ¢ */
        .mode-toggle {
            display: flex;
            background: #E5E5EA;
            padding: 4px;
            margin: 20px 20px 0;
            border-radius: 10px;
        }

        .toggle-btn {
            flex: 1;
            border: none;
            background: none;
            padding: 10px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-btn.active {
            background: var(--card-bg);
            color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        /* ä¸»è¦å†…å®¹åŒº */
        .content {
            padding: 25px;
        }

        /* SVG å›¾ç¤ºåŒºåŸŸ */
        .diagram-box {
            height: 160px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
        }
        
        svg { overflow: visible; }
        .line-path { stroke: var(--primary-color); stroke-width: 3; fill: none; stroke-linecap: round; }
        .line-dashed { stroke: var(--secondary-color); stroke-width: 2.5; stroke-dasharray: 6, 4; fill: none; }
        .point-marker { fill: var(--primary-color); }
        .point-label { font-size: 16px; font-weight: 700; fill: var(--text-dark); }
        .point-desc { font-size: 12px; fill: var(--text-gray); }

        /* è¾“å…¥è¡¨å• */
        .input-group { margin-bottom: 20px; }
        .input-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-gray);
            margin-bottom: 8px;
        }
        .input-field {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border: 2px solid #E5E5EA;
            border-radius: 12px;
            background: #F9F9F9;
            box-sizing: border-box;
            transition: border-color 0.2s;
            font-family: 'Courier New', Courier, monospace; /* æ•°å­—ç”¨ç­‰å®½å­—ä½“æ›´å¥½çœ‹ */
            font-weight: bold;
        }
        .input-field:focus {
            border-color: var(--primary-color);
            outline: none;
            background: #FFF;
        }

        /* è®¡ç®—æŒ‰é’® */
        .calc-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 5px 15px rgba(0, 122, 255, 0.3);
        }
        .calc-btn:active { transform: scale(0.98); }

        /* ç»“æœåŒºåŸŸ */
        .results-area {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #E5E5EA;
            display: none; /* é»˜è®¤éšè— */
        }
        .results-area.show { display: block; animation: slideDown 0.4s ease-out; }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card {
            background: #F0F9F4;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 5px solid var(--success-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .res-title { font-size: 14px; color: var(--text-gray); font-weight: 600; }
        .res-value { font-size: 22px; color: var(--text-dark); font-weight: 800; font-family: 'Courier New', monospace; }

    </style>
</head>
<body>

<div class="container">
    <div class="mode-toggle">
        <button class="toggle-btn active" onclick="setMode('rise')">ğŸ“ˆ ä¸Šæ¶¨æµ‹å›è°ƒ (å€’V)</button>
        <button class="toggle-btn" onclick="setMode('fall')">ğŸ“‰ ä¸‹è·Œæµ‹åå¼¹ (Vå‹)</button>
    </div>

    <div class="content">
        <div class="diagram-box" id="diagram"></div>

        <div class="input-section">
            <div class="input-group">
                <label class="input-label" id="labelA">Aç‚¹ä»·æ ¼ (èµ·ç‚¹):</label>
                <input type="number" id="inputA" class="input-field" placeholder="è¯·è¾“å…¥ä»·æ ¼" step="0.01">
            </div>
            <div class="input-group">
                <label class="input-label" id="labelB">Bç‚¹ä»·æ ¼ (ç»ˆç‚¹):</label>
                <input type="number" id="inputB" class="input-field" placeholder="è¯·è¾“å…¥ä»·æ ¼" step="0.01">
            </div>
            <button class="calc-btn" onclick="calculate(true)">å¼€å§‹è®¡ç®—ç›®æ ‡ä½</button>
        </div>

        <div class="results-area" id="resultsBox">
            <div class="result-card">
                <div>
                    <div class="res-title">ç›®æ ‡ä½ä¸€ (å‡ ä½•å¹³å‡)</div>
                    <div class="res-desc" style="font-size:12px;color:#999">å…¬å¼: âˆšAÃ—B</div>
                </div>
                <div class="res-value" id="val1">0.0000</div>
            </div>
            <div class="result-card" style="background: #F2F7FF; border-left-color: var(--primary-color);">
                <div>
                    <div class="res-title">ç›®æ ‡ä½äºŒ (åŠ æƒç³»æ•°)</div>
                    <div class="res-desc" id="formula2Desc" style="font-size:12px;color:#999">å…¬å¼: ...</div>
                </div>
                <div class="res-value" id="val2">0.0000</div>
            </div>
        </div>
    </div>
</div>

<script>
    let currentMode = 'rise';

    // åˆå§‹åŒ–
    window.onload = () => {
        setMode('rise');
        const elA = document.getElementById('inputA');
        const elB = document.getElementById('inputB');

        // å®æ—¶æ›´æ–°ï¼šè¾“å…¥å˜åŒ–å°±è®¡ç®—ï¼ˆä¸å¼¹çª—ã€ä¸æ‰“æ–­ï¼‰
        elA.addEventListener('input', () => calculate(false));
        elB.addEventListener('input', () => calculate(false));

        // ç§»åŠ¨ç«¯æ›´é¡ºæ‰‹ï¼šå›è½¦/å®Œæˆä¹Ÿè§¦å‘ä¸€æ¬¡
        elA.addEventListener('change', () => calculate(false));
        elB.addEventListener('change', () => calculate(false));
    };

    function setMode(mode) {
        currentMode = mode;
        const btns = document.querySelectorAll('.toggle-btn');
        
        if (mode === 'rise') {
            btns[0].classList.add('active');
            btns[1].classList.remove('active');
            document.getElementById('labelA').innerText = "Aç‚¹ä»·æ ¼ (èµ·ç‚¹/ä½ç‚¹):";
            document.getElementById('labelB').innerText = "Bç‚¹ä»·æ ¼ (é«˜ç‚¹):";
            document.getElementById('formula2Desc').innerText = "å…¬å¼: 0.749A + 0.251B";
            renderRiseSVG();
        } else {
            btns[0].classList.remove('active');
            btns[1].classList.add('active');
            document.getElementById('labelA').innerText = "Aç‚¹ä»·æ ¼ (èµ·ç‚¹/é«˜ç‚¹):";
            document.getElementById('labelB').innerText = "Bç‚¹ä»·æ ¼ (ä½ç‚¹):";
            document.getElementById('formula2Desc').innerText = "å…¬å¼: 0.746A + 0.254B";
            renderFallSVG();
        }
        // åˆ‡æ¢æ¨¡å¼æ—¶ï¼šå¦‚æœè¾“å…¥å®Œæ•´å°±ç«‹å³æ›´æ–°ç»“æœï¼Œå¦åˆ™éšè—ç»“æœ
        calculate(false);
    }

    function calculate(forceAlert = false) {
        const aVal = document.getElementById('inputA').value;
        const bVal = document.getElementById('inputB').value;
        const resultsBox = document.getElementById('resultsBox');

        // å®æ—¶æ¨¡å¼ï¼šè¾“å…¥ä¸å®Œæ•´æ—¶ä¸å¼¹çª—ï¼Œç›´æ¥éšè—ç»“æœ
        if (aVal === "" || bVal === "") {
            if (forceAlert) alert("è¯·å…ˆè¾“å…¥Aç‚¹å’ŒBç‚¹çš„ä»·æ ¼");
            resultsBox.classList.remove('show');
            return;
        }

        const a = parseFloat(aVal);
        const b = parseFloat(bVal);

        // å…œåº•ï¼šéæ•°å€¼æ—¶éšè—
        if (!isFinite(a) || !isFinite(b)) {
            if (forceAlert) alert("è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—");
            resultsBox.classList.remove('show');
            return;
        }

        let c1, c2;

        // æ ¸å¿ƒç®—æ³•
        c1 = Math.sqrt(a * b); // ç›®æ ‡ä¸€ï¼šå‡ ä½•å¹³å‡

        if (currentMode === 'rise') {
            // ä¸Šæ¶¨æµ‹å›è°ƒ: Aæ˜¯ä½, Bæ˜¯é«˜. ç³»æ•°: ä½ç‚¹x0.749 + é«˜ç‚¹x0.251
            c2 = 0.749 * a + 0.251 * b;
        } else {
            // ä¸‹è·Œæµ‹åå¼¹: Aæ˜¯é«˜, Bæ˜¯ä½. ç³»æ•°: é«˜ç‚¹x0.746 + ä½ç‚¹x0.254
            c2 = 0.746 * a + 0.254 * b;
        }

        // æ˜¾ç¤ºç»“æœï¼ˆå®æ—¶æ›´æ–°ï¼‰
        document.getElementById('val1').innerText = c1.toFixed(4);
        document.getElementById('val2').innerText = c2.toFixed(4);
        resultsBox.classList.add('show');
    }

    // æ¸²æŸ“ä¸Šæ¶¨ç¤ºæ„å›¾ (å€’V)
    function renderRiseSVG() {
        const svg = `
            <svg width="260" height="140" viewBox="0 0 260 140">
                <path d="M 40 120 L 130 30" class="line-path" />
                <path d="M 130 30 L 180 80" class="line-dashed" />
                <circle cx="40" cy="120" r="5" class="point-marker"/>
                <text x="30" y="135" class="point-label" text-anchor="middle">A</text>
                <text x="30" y="150" class="point-desc" text-anchor="middle">èµ·ç‚¹(ä½)</text>
                
                <circle cx="130" cy="30" r="5" class="point-marker"/>
                <text x="130" y="20" class="point-label" text-anchor="middle">B</text>
                <text x="165" y="20" class="point-desc">é«˜ç‚¹</text>

                <text x="190" y="85" class="point-label" fill="var(--secondary-color)">C?</text>
                <text x="195" y="100" class="point-desc">å›è°ƒç›®æ ‡</text>
            </svg>
        `;
        document.getElementById('diagram').innerHTML = svg;
    }

    // æ¸²æŸ“ä¸‹è·Œç¤ºæ„å›¾ (Vå‹)
    function renderFallSVG() {
        const svg = `
            <svg width="260" height="140" viewBox="0 0 260 140">
                <path d="M 40 30 L 130 120" class="line-path" />
                <path d="M 130 120 L 180 70" class="line-dashed" />
                <circle cx="40" cy="30" r="5" class="point-marker"/>
                <text x="30" y="35" class="point-label" text-anchor="middle">A</text>
                <text x="30" y="50" class="point-desc" text-anchor="middle">èµ·ç‚¹(é«˜)</text>
                
                <circle cx="130" cy="120" r="5" class="point-marker"/>
                <text x="130" y="145" class="point-label" text-anchor="middle">B</text>
                <text x="165" y="145" class="point-desc">ä½ç‚¹</text>

                <text x="190" y="75" class="point-label" fill="var(--secondary-color)">C?</text>
                <text x="195" y="60" class="point-desc">åå¼¹ç›®æ ‡</text>
            </svg>
        `;
        document.getElementById('diagram').innerHTML = svg;
    }
</script>

</body>
</html>